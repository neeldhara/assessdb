let d=!1;function v(){if(d)return;const g=document.getElementById("searchInput"),f=document.getElementById("assessmentsGrid"),k=document.getElementById("noResults"),E=document.querySelectorAll(".difficulty-filter"),b=document.getElementById("paginationInfo"),w=document.getElementById("paginationControls"),L=document.getElementById("currentPageInfo"),I=document.getElementById("totalCount"),y=document.getElementById("prevPage"),p=document.getElementById("nextPage"),h=document.getElementById("pageNumbers");if(!g||!f||!k){console.error("CS101: Required elements not found",{searchInput:!!g,assessmentsGrid:!!f,noResults:!!k});return}console.log("CS101: Initializing pagination...");const P=Array.from(f.querySelectorAll(".assessment-card")),S=document.querySelectorAll(".bookmark-filter");let M="",T="all",m="all",a=1;const u=12;function A(){return P.filter(o=>{const t=o.querySelector(".assessment-title"),e=o;if(!t||!t.textContent)return!1;const i=t.textContent.toLowerCase(),n=e.getAttribute("data-difficulty")||"",s=M===""||i.includes(M),r=T==="all"||n===T;let c=!0;if(m!=="all"){const N=o.querySelector(".bookmark-btn")?.getAttribute("data-problem-id"),V=window.bookmarkManager&&N?window.bookmarkManager.isBookmarked(N):!1;m==="bookmarked"?c=V:m==="unbookmarked"&&(c=!V)}return s&&r&&c})}function F(o){const t=o.length,e=Math.ceil(t/u);if(t===0)L.textContent="0-0",I.textContent="0";else{const i=(a-1)*u+1,n=Math.min(a*u,t);L.textContent=`${i}-${n}`,I.textContent=t.toString()}if(y&&p&&(y.disabled=a<=1,p.disabled=a>=e),h&&(h.innerHTML="",e>1)){let n=Math.max(1,a-Math.floor(2.5)),s=Math.min(e,n+5-1);s-n+1<5&&(n=Math.max(1,s-5+1));for(let r=n;r<=s;r++){const c=document.createElement("button");c.textContent=r.toString(),c.className=`px-3 py-2 text-sm font-medium rounded-lg ${r===a?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-300"}`,c.addEventListener("click",()=>{a=r,l()}),h.appendChild(c)}}w&&(w.style.display=e>1?"flex":"none"),b&&(b.style.display=t>0?"block":"none")}function l(){const o=A(),t=o.length;if(P.forEach(e=>{e.style.display="none"}),t===0)k?.classList.remove("hidden"),f?.classList.add("hidden");else{k?.classList.add("hidden"),f?.classList.remove("hidden");const e=(a-1)*u,i=e+u;o.slice(e,i).forEach(s=>{s.style.display="flex"})}F(o)}g.addEventListener("input",function(){M=this.value.toLowerCase().trim(),a=1,l()}),E.forEach(o=>{o.addEventListener("click",function(){E.forEach(t=>t.classList.remove("active")),this.classList.add("active"),T=this.getAttribute("data-difficulty")||"all",a=1,l()})}),S.forEach(o=>{o.addEventListener("click",function(){S.forEach(t=>t.classList.remove("active")),this.classList.add("active"),m=this.getAttribute("data-bookmark")||"all",a=1,l()})});function $(){document.querySelectorAll(".bookmark-btn").forEach(t=>{t.addEventListener("click",async function(e){e.preventDefault(),e.stopPropagation();const i=this.getAttribute("data-problem-id"),n=this.getAttribute("data-problem-title")||"";if(i){if(!window.loginModal||!window.loginModal.isLoggedIn()){this.classList.add("animate-pulse");const s=this.getAttribute("title");this.setAttribute("title","Please log in to bookmark problems"),z("Please log in to bookmark problems"),setTimeout(()=>{this.classList.remove("animate-pulse"),this.setAttribute("title",s||"Bookmark this problem")},2e3);const r=new CustomEvent("showLoginModal");document.dispatchEvent(r);return}if(window.bookmarkManager&&(window.bookmarkManager.isBookmarked(i),await window.bookmarkManager.toggleBookmark(i,n))){const r=window.bookmarkManager.isBookmarked(i);q(this,r),z(`Problem ${r?"added to":"removed from"} bookmarks`),m!=="all"&&l()}}})})}function q(o,t){const e=o.querySelector(".bookmark-icon");e&&(e.textContent=t?"ðŸ“š":"ðŸ”–",o.setAttribute("title",t?"Remove bookmark":"Bookmark this problem"))}function B(){if(!window.bookmarkManager)return;document.querySelectorAll(".bookmark-btn").forEach(t=>{const e=t.getAttribute("data-problem-id");if(e){const i=window.bookmarkManager.isBookmarked(e);q(t,i)}})}function z(o){const t=document.querySelector(".bookmark-toast");t&&t.remove();const e=document.createElement("div");e.className="bookmark-toast fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300",e.textContent=o,document.body.appendChild(e),setTimeout(()=>{e.classList.remove("translate-x-full")},10),setTimeout(()=>{e.classList.add("translate-x-full"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)},3e3)}y?.addEventListener("click",()=>{a>1&&(a--,l())}),p?.addEventListener("click",()=>{const o=A(),t=Math.ceil(o.length/u);a<t&&(a++,l())}),document.querySelector('.difficulty-filter[data-difficulty="all"]')?.classList.add("active");function R(){const o=P.length,t=Math.ceil(o/u);if(b&&o>0){if(b.style.display="block",L){const e=Math.min(u,o);L.textContent=`1-${e}`}I&&(I.textContent=o.toString())}if(w&&t>1&&(w.style.display="flex"),h&&t>1){h.innerHTML="";const i=Math.min(t,5);for(let n=1;n<=i;n++){const s=document.createElement("button");s.textContent=n.toString(),s.className=`px-3 py-2 text-sm font-medium rounded-lg ${n===1?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-300"}`,s.addEventListener("click",()=>{a=n,l()}),h.appendChild(s)}}y&&(y.disabled=!0),p&&(p.disabled=t<=1)}R(),$(),document.addEventListener("bookmarksUpdated",function(){B(),m!=="all"&&l()}),document.addEventListener("userbaseLogin",function(){setTimeout(()=>{B()},100)}),document.addEventListener("userbaseLogout",function(){B(),m!=="all"&&(m="all",S.forEach(o=>o.classList.remove("active")),document.querySelector('.bookmark-filter[data-bookmark="all"]')?.classList.add("active"),l())}),l(),setTimeout(()=>{B()},500),d=!0,console.log("CS101: Pagination initialized successfully")}function G(){const g=new MutationObserver(f=>{f.forEach(k=>{if(k.type==="childList"){const E=document.getElementById("paginationInfo"),b=document.getElementById("paginationControls");E&&b&&!d&&(console.log("CS101: Pagination elements detected, initializing..."),v(),g.disconnect())}})});g.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{g.disconnect()},5e3)}function x(){d=!1,v(),d||(console.log("CS101: Initial attempt failed, starting DOM observer..."),G(),setTimeout(()=>{d||(d=!1,v())},100),setTimeout(()=>{d||(d=!1,v())},500),setTimeout(()=>{d||(d=!1,v())},1e3))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",x):x();let D;function C(){clearTimeout(D),D=setTimeout(x,100)}window.addEventListener("popstate",C);document.addEventListener("visibilitychange",function(){document.hidden||C()});window.addEventListener("pageshow",C);window.addEventListener("focus",C);document.addEventListener("astro:page-load",x);document.addEventListener("astro:after-swap",x);
